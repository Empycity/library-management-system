-- ==========================================
-- 图书馆管理系统示例数据插入脚本
-- ==========================================
-- 功能说明：
-- 1. 清空现有数据（保留结构）
-- 2. 插入示例图书分类数据
-- 3. 插入示例管理员数据
-- 4. 插入示例图书数据
-- 5. 插入示例读者数据
-- 6. 插入示例借阅记录数据
-- 
-- 注意：此脚本会清空现有数据，请谨慎使用！
-- 
-- 作者: 图书馆管理系统开发团队
-- 版本: 1.0
-- 创建日期: 2024-01-15
-- ==========================================

USE library_management;

-- ==========================================
-- 清空现有数据（保留表结构）
-- ==========================================

SET FOREIGN_KEY_CHECKS = 0;

TRUNCATE TABLE system_logs;
TRUNCATE TABLE reservations;
TRUNCATE TABLE borrows;
TRUNCATE TABLE books;
TRUNCATE TABLE readers;
TRUNCATE TABLE admins;
TRUNCATE TABLE categories;

SET FOREIGN_KEY_CHECKS = 1;

-- ==========================================
-- 插入图书分类数据
-- ==========================================

INSERT INTO categories (id, name, code, description, sort_order, status) VALUES
(1, '计算机科学', 'CS', '计算机科学与技术、软件工程、人工智能等相关图书', 1, 'active'),
(2, '文学', 'LIT', '中外文学作品、诗歌、散文、小说等', 2, 'active'),
(3, '历史', 'HIST', '中外历史、传记、考古等历史类图书', 3, 'active'),
(4, '自然科学', 'SCI', '数学、物理、化学、生物等自然科学图书', 4, 'active'),
(5, '艺术', 'ART', '美术、音乐、舞蹈、设计等艺术类图书', 5, 'active'),
(6, '哲学', 'PHIL', '哲学理论、逻辑学、伦理学等哲学类图书', 6, 'active'),
(7, '经济管理', 'ECON', '经济学、管理学、金融学等商科图书', 7, 'active'),
(8, '教育', 'EDU', '教育理论、教学方法、心理学等教育类图书', 8, 'active');

-- ==========================================
-- 插入管理员数据
-- ==========================================

INSERT INTO admins (id, username, password, real_name, email, phone, role, status) VALUES
(1, 'admin', '0192023a7bbd73250516f069df18b500', '系统管理员', 'admin@library.com', '13800138000', 'super_admin', 'active'),
(2, 'librarian1', 'e10adc3949ba59abbe56e057f20f883e', '张图书', 'zhang@library.com', '13800138001', 'librarian', 'active'),
(3, 'librarian2', 'e10adc3949ba59abbe56e057f20f883e', '李管理', 'li@library.com', '13800138002', 'librarian', 'active');

-- ==========================================
-- 插入图书数据
-- ==========================================

INSERT INTO books (id, isbn, title, author, publisher, category_id, publish_date, price, location, description, status) VALUES
-- 计算机科学类图书
(1, '9787111544937', 'Java核心技术 卷I', 'Cay S. Horstmann', '机械工业出版社', 1, '2018-09-01', 119.00, 'A区1层CS001', 'Java编程经典教材，适合初学者和进阶开发者', 'available'),
(2, '9787115428028', 'Python编程：从入门到实践', 'Eric Matthes', '人民邮电出版社', 1, '2016-07-01', 89.00, 'A区1层CS002', 'Python编程入门经典，项目驱动学习', 'available'),
(3, '9787111213826', '算法导论', 'Thomas H. Cormen', '机械工业出版社', 1, '2012-12-01', 128.00, 'A区1层CS003', '算法和数据结构的权威教材', 'borrowed'),
(4, '9787115404831', 'JavaScript高级程序设计', 'Nicholas C. Zakas', '人民邮电出版社', 1, '2015-10-01', 99.00, 'A区1层CS004', 'JavaScript开发者必读经典', 'available'),
(5, '9787111558422', '深入理解计算机系统', 'Randal E. Bryant', '机械工业出版社', 1, '2016-11-01', 139.00, 'A区1层CS005', '计算机系统底层原理详解', 'available'),

-- 文学类图书
(6, '9787020002207', '红楼梦', '曹雪芹', '人民文学出版社', 2, '1996-12-01', 39.50, 'B区2层LIT001', '中国古典文学四大名著之一', 'available'),
(7, '9787020008735', '围城', '钱钟书', '人民文学出版社', 2, '1991-02-01', 28.00, 'B区2层LIT002', '现代文学经典作品', 'available'),
(8, '9787544270878', '百年孤独', '加西亚·马尔克斯', '南海出版公司', 2, '2011-06-01', 39.50, 'B区2层LIT003', '魔幻现实主义文学代表作', 'borrowed'),
(9, '9787020024759', '平凡的世界', '路遥', '人民文学出版社', 2, '1993-05-01', 64.00, 'B区2层LIT004', '茅盾文学奖获奖作品', 'available'),
(10, '9787544291170', '1984', '乔治·奥威尔', '南海出版公司', 2, '2018-08-01', 35.00, 'B区2层LIT005', '反乌托邦文学经典', 'available'),

-- 历史类图书
(11, '9787101003048', '史记', '司马迁', '中华书局', 3, '1982-11-01', 198.00, 'C区3层HIST001', '中国第一部纪传体通史', 'available'),
(12, '9787108009982', '万历十五年', '黄仁宇', '生活·读书·新知三联书店', 3, '1997-05-01', 18.00, 'C区3层HIST002', '大历史观的经典之作', 'available'),
(13, '9787208061644', '全球通史', '斯塔夫里阿诺斯', '上海社会科学院出版社', 3, '2006-10-01', 68.00, 'C区3层HIST003', '世界历史的宏观叙述', 'available'),

-- 自然科学类图书
(14, '9787040396638', '高等数学', '同济大学数学系', '高等教育出版社', 4, '2014-07-01', 62.20, 'D区4层SCI001', '高等数学经典教材', 'available'),
(15, '9787040264517', '大学物理', '马文蔚', '高等教育出版社', 4, '2009-01-01', 49.00, 'D区4层SCI002', '大学物理基础教程', 'available'),

-- 艺术类图书
(16, '9787102049946', '中国美术史', '中央美术学院', '人民美术出版社', 5, '2009-09-01', 98.00, 'E区5层ART001', '中国美术发展史', 'available'),
(17, '9787103033647', '音乐理论基础', '李重光', '人民音乐出版社', 5, '2000-06-01', 25.00, 'E区5层ART002', '音乐理论入门教材', 'available'),

-- 哲学类图书
(18, '9787100004725', '论语', '孔子', '商务印书馆', 6, '1958-12-01', 9.90, 'F区6层PHIL001', '儒家经典著作', 'available'),
(19, '9787100018166', '西方哲学史', '罗素', '商务印书馆', 6, '1963-08-01', 88.00, 'F区6层PHIL002', '西方哲学发展史', 'available'),

-- 经济管理类图书
(20, '9787111213123', '经济学原理', '曼昆', '机械工业出版社', 7, '2009-04-01', 78.00, 'G区7层ECON001', '经济学入门经典教材', 'available');

-- ==========================================
-- 插入读者数据
-- ==========================================

INSERT INTO readers (id, card_number, name, gender, birth_date, phone, email, address, register_date, max_borrow_count, status) VALUES
(1, 'R20240001', '张三', '男', '1995-03-15', '13812345678', 'zhangsan@email.com', '北京市海淀区中关村大街1号', '2024-01-15', 5, 'active'),
(2, 'R20240002', '李四', '女', '1998-07-22', '13987654321', 'lisi@email.com', '上海市浦东新区陆家嘴环路1000号', '2024-01-16', 5, 'active'),
(3, 'R20240003', '王五', '男', '1992-11-08', '15612345678', 'wangwu@email.com', '广州市天河区珠江新城花城大道85号', '2024-01-17', 5, 'active'),
(4, 'R20240004', '赵六', '女', '1996-05-30', '18712345678', 'zhaoliu@email.com', '深圳市南山区科技园南区深南大道9988号', '2024-01-18', 5, 'active'),
(5, 'R20240005', '钱七', '男', '1994-09-12', '13698765432', 'qianqi@email.com', '杭州市西湖区文三路259号', '2024-01-19', 5, 'active'),
(6, 'R20240006', '孙八', '女', '1997-12-25', '15987654321', 'sunba@email.com', '南京市鼓楼区中山路1号', '2024-01-20', 5, 'active'),
(7, 'R20240007', '周九', '男', '1993-04-18', '18665432109', 'zhoujiu@email.com', '武汉市洪山区珞喻路129号', '2024-01-21', 5, 'active'),
(8, 'R20240008', '吴十', '女', '1999-08-03', '13776543210', 'wushi@email.com', '成都市锦江区红星路三段1号', '2024-01-22', 5, 'active'),
(9, 'R20240009', '郑一', '男', '1991-01-14', '15543210987', 'zhengyi@email.com', '西安市雁塔区高新路88号', '2024-01-23', 5, 'active'),
(10, 'R20240010', '王二', '女', '2000-06-07', '18854321098', 'wanger@email.com', '青岛市市南区香港中路40号', '2024-01-24', 5, 'active');

-- ==========================================
-- 插入借阅记录数据
-- ==========================================

INSERT INTO borrows (id, reader_id, book_id, borrow_date, due_date, return_date, renew_count, fine_amount, status, notes) VALUES
-- 已归还的借阅记录
(1, 1, 1, '2024-01-15', '2024-02-14', '2024-02-10', 0, 0.00, 'returned', '按时归还'),
(2, 2, 2, '2024-01-16', '2024-02-15', '2024-02-12', 0, 0.00, 'returned', '按时归还'),
(3, 3, 4, '2024-01-17', '2024-02-16', '2024-02-20', 1, 2.00, 'returned', '逾期4天归还，已缴纳罚款'),
(4, 4, 5, '2024-01-18', '2024-02-17', '2024-02-15', 0, 0.00, 'returned', '按时归还'),
(5, 5, 6, '2024-01-19', '2024-02-18', '2024-02-16', 0, 0.00, 'returned', '按时归还'),

-- 当前借阅中的记录
(6, 1, 3, '2024-02-15', '2024-03-16', NULL, 0, 0.00, 'borrowed', '正常借阅中'),
(7, 3, 8, '2024-02-20', '2024-03-21', NULL, 1, 0.00, 'borrowed', '已续借一次'),

-- 预约记录（如果需要的话）
(8, 6, 7, '2024-02-25', '2024-03-26', NULL, 0, 0.00, 'borrowed', '正常借阅中'),
(9, 7, 9, '2024-03-01', '2024-03-31', NULL, 0, 0.00, 'borrowed', '正常借阅中'),
(10, 8, 10, '2024-03-05', '2024-04-04', NULL, 0, 0.00, 'borrowed', '正常借阅中');

-- ==========================================
-- 插入系统日志数据（示例）
-- ==========================================

INSERT INTO system_logs (user_type, user_id, action, target_type, target_id, description, ip_address) VALUES
('admin', 1, '系统初始化', 'system', NULL, '管理员初始化系统数据', '127.0.0.1'),
('admin', 1, '添加图书', 'book', 1, '添加图书：Java核心技术 卷I', '127.0.0.1'),
('admin', 1, '添加读者', 'reader', 1, '添加读者：张三', '127.0.0.1'),
('admin', 2, '创建借阅', 'borrow', 1, '创建借阅记录：读者张三借阅Java核心技术', '192.168.1.100'),
('admin', 2, '归还图书', 'borrow', 1, '图书归还：Java核心技术', '192.168.1.100');

-- ==========================================
-- 数据插入完成提示
-- ==========================================

SELECT '示例数据插入完成！' as message;
SELECT 
    (SELECT COUNT(*) FROM categories) as '分类数量',
    (SELECT COUNT(*) FROM books) as '图书数量',
    (SELECT COUNT(*) FROM readers) as '读者数量',
    (SELECT COUNT(*) FROM borrows) as '借阅记录数量',
    (SELECT COUNT(*) FROM admins) as '管理员数量';

-- 显示当前借阅状态统计
SELECT 
    status as '借阅状态',
    COUNT(*) as '数量'
FROM borrows 
GROUP BY status
ORDER BY status;